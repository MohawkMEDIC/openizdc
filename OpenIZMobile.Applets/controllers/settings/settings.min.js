layoutApp.controller("SettingsController",["$scope",function(n){OpenIZ.Authentication.$session==null&&(OpenIZ.Authentication.$session={});OpenIZ.App.showWait();OpenIZ.Configuration.getConfigurationAsync({continueWith:function(t){n.config=t;n.config.network.useProxy=n.config.network.proxyAddress!=null;n.config.network.proxyAddress=n.config.network.proxyAddress||null;n.ui={dataCollapsed:!0,securityCollapsed:!0};n.config.data.mode="sync";n.config.data.sync={event:[],enablePoll:t.sync.pollInterval,pollInterval:t.sync.pollInterval};n.config.log.mode=n.config.log.trace[0].filter||"Warning";n.config.security.hasher=OpenIZ.App.getService("IPasswordHashingService")||"SHA256PasswordHasher";n.config.security.offline={enable:!1};n.$apply()},onException:function(n){n.message!=null?console.log(n.message):console.log(n)},"finally":function(){OpenIZ.App.hideWait()}});n.master={};n.leaveRealm=function(){confirm(OpenIZ.Localization.getString("locale.settings.confirm.leaveRealm"))&&OpenIZ.Configuration.leaveRealmAsync()};n.joinRealm=function(t){var i=function(r){OpenIZ.App.showWait();OpenIZ.Configuration.joinRealmAsync({domain:t.domain,deviceName:t.deviceName,enableTrace:t.enableTrace,force:r,continueWith:function(t){n.config.realmName=t.realmName;alert(OpenIZ.Localization.getString("locale.settings.status.joinRealm"))},onException:function(n){n.type=="DuplicateNameException"&&(confirm(OpenIZ.Localization.getString("locale.settings.status.duplicateName"))?i(!0):n.message!=null?alert(n.message):console.log(n))},"finally":function(){OpenIZ.App.hideWait()}})};OpenIZ.Authentication.$elevationCredentials.continueWith=i;i()};n.save=function(t){n.config.realmName==null?alert(OpenIZ.Localization.getString("locale.settings.error.noRealm")):(OpenIZ.App.showWait(),OpenIZ.Configuration.saveAsync({data:t,continueWith:function(){OpenIZ.App.close()}}))}}]);