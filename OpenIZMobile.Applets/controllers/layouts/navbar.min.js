layoutApp.controller("LayoutController",["$scope","$interval","$rootScope","$window",function(n,t,i,r){OpenIZ.App.getMenusAsync({continueWith:function(t){n.menuItems=t;n.$applyAsync()}});n.logout=n.logout||function(){confirm(OpenIZ.Localization.getString("locale.layout.navbar.logout.confirm"))&&OpenIZ.Authentication.abandonSession({continueWith:function(n){console.log(n);window.location.hash="#/";r.location.reload()},onException:function(n){console.log(n)}})};n.setLocale=n.setLocale||function(n){OpenIZ.Localization.setLocale(n);window.location.hash="#/";r.location.reload(!0)};n.checkMessages=function(){OpenIZ.App.getAlertsAsync({query:{flags:"!2"},continueWith:function(t){var r;if((n.messages==null||t.length!=n.messages.length)&&(r=t.length-(n.messages==null?0:n.messages.length),i.session!=null)){var u={preventDuplicates:!0,showDuration:150,hideDuration:250,timeout:2e3};n.messages&&(r==1?toastr.success(t[0].subject+"...",t[0].from,u):toastr.success(OpenIZ.Localization.getString("locale.alerts.newAlerts"),u));n.messages=t;n.$apply()}setTimeout(n.checkMessages,3e4)}});OpenIZ.Queue.getQueueAsync({queueName:OpenIZ.Queue.QueueNames.DeadLetterQueue,continueWith:function(t){n.conflicts=t},onException:function(){}})};setTimeout(n.checkMessages,3e4);n.checkMessages();n.$watch(function(){return window.innerWidth},function(t){n.windowWidth=t})}]);