$(document).ready(function(){$("table.oiz-patient-results").each(function(n,t){var i=angular.element(t).scope(),r;i.search=i.search||{};i.search.query=i.search.query||{};i.search.results=null;i.search.paging=i.search.paging||{size:10};r=function(){for(var n in i.search.results.item)OpenIZ.Act.findAsync({query:{classConcept:OpenIZModel.ActClassKeys.Encounter,statusConcept:OpenIZModel.StatusKeys.Active,moodConcept:OpenIZModel.ActMoodKeys.Eventoccurrence,"participation[RecordTarget].player":i.search.results.item[n].id,_count:0},continueWith:function(t){t!=null&&(i.search.results.item[n]._isInEncounter=t.totalResults>0);i.$apply()}})};i.search.search=i.search.search||function(n){n||OpenIZ.App.showWait(OpenIZ.Localization.getString("locale.dialog.wait.text"));i.search.query._offset=0;i.search.query._count=i.search.paging.size;OpenIZ.Patient.findAsync({query:i.search.query,continueWith:function(n){i.search.results=n;i.search.paging={current:1,total:n.totalResults==0?1:n.totalResults/i.search.paging.size,size:i.search.paging.size,pages:[]};for(var t=0;t<i.search.paging.total;t++)i.search.paging.pages[t]=t+1;r();i.$apply()},onException:function(n){OpenIZ.App.toast(n.message)},"finally":function(){OpenIZ.App.hideWait()}})};i.search.next=i.search.next||function(){(OpenIZ.App.showWait(OpenIZ.Localization.getString("locale.dialog.wait.text")),i.search.paging.current!=i.search.paging.count)&&(i.search.paging.current++,i.search.query._offset=(i.search.paging.current-1)*i.search.paging.size,i.search.query._count=i.search.paging.size,OpenIZ.Patient.findAsync({query:i.search.query,continueWith:function(n){i.search.results=n;r();i.$apply()},onException:function(n){OpenIZ.App.toast(n.message)},"finally":function(){OpenIZ.App.hideWait()}}))};i.search.previous=i.search.previous||function(){(OpenIZ.App.showWait(OpenIZ.Localization.getString("locale.dialog.wait.text")),i.search.paging.current!=1)&&(i.search.paging.current--,i.search.query._offset=(i.search.paging.current-1)*i.search.paging.size,i.search.query._count=i.search.paging.size,OpenIZ.Patient.findAsync({query:i.search.query,continueWith:function(n){i.search.results=n;r();i.$apply()},onException:function(n){OpenIZ.App.toast(n.message)},"finally":function(){OpenIZ.App.hideWait()}}))};i.search.goPage=i.search.goPage||function(n){OpenIZ.App.showWait(OpenIZ.Localization.getString("locale.dialog.wait.text"));i.search.paging.current=n;i.search.query._offset=(i.search.paging.current-1)*i.search.paging.size;i.search.query._count=i.search.paging.size;OpenIZ.Patient.findAsync({query:i.search.query,continueWith:function(n){i.search.results=n;r();i.$apply()},onException:function(n){OpenIZ.App.toast(n.message)},"finally":function(){OpenIZ.App.hideWait()}})};i.act={};i.startEncounter=function(n){i.doStartEncounter(n)}})});