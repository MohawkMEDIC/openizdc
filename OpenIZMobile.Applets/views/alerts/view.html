<!--
 - Copyright 2015-2016 Mohawk College of Applied Arts and Technology
 -
 - 
 - Licensed under the Apache License, Version 2.0 (the "License"); you 
 - may not use this file except in compliance with the License. You may 
 - obtain a copy of the License at 
 - 
 - http://www.apache.org/licenses/LICENSE-2.0 
 - 
 - Unless required by applicable law or agreed to in writing, software
 - distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 - WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the 
 - License for the specific language governing permissions and limitations under 
 - the License.
 - 
 - User: justi
 - Date: 2016-8-17
 -->
<div class="container-fluid no-padding-all" xmlns="http://www.w3.org/1999/xhtml" xmlns:oiz="http://openiz.org/applet">
    <oiz:script>/org.openiz.core/controllers/alerts/view.js</oiz:script>
    <oiz:state name="org-openiz-core.alert">
        <oiz:url>/alert/{alertId}</oiz:url>
        <oiz:view>
            <oiz:controller>ViewAlertController</oiz:controller>
            <oiz:title>Alert</oiz:title>
        </oiz:view>
    </oiz:state>
    
    <div class="row">
        <div class="col-portrait-12 col-sm-5 padding-10 padding-top-15 no-padding-right" ng-class="{'hidden-portrait' : selectedMessageID != null}">
            <div ng-repeat="message in messages" 
                 class="alerts-tile row no-margin-left no-margin-right" 
                 ui-sref="org-openiz-core.alert({alertId: message.id})"
                 ng-class="{'alerts-tile-selected' : message.id == selectedMessageID}">
                <div class="col-xs-2 alerts-icon-container">
                    <img class="alerts-icon" src="/org.openiz.core/img/msg/{{message.flags}}.png" />
                </div>
                <div class="col-xs-10">
                    <div class="subject ellipsis">{{message.subject}}</div>
                    <div class="sender ellipsis">{{message.from}}</div>
                    <div class="text-muted">{{message.time | date: 'yyyy-MM-dd HH:mm'}}</div>
                </div>
            </div>
            <div class="vaccinations-tile no-margin-left no-margin-right row padding-10 padding-top-15 no-padding-right" 
                 ng-if="!messages || messages.length == 0">
                <div class="col-xs-12">{{ 'locale.alerts.noalerts' | i18n }}</div>
            </div>
        </div>
        <div class="hidden-xs col-sm-7 padding-10 padding-top-15" ng-class="{'force-show full-width-portrait' : selectedMessageID != null}">
            <div class="message-content-tile">
                <div class="message-button-bar">
                    <button class="btn hidden-landscape" ng-click="closeMessage()">
                        <span class="glyphicon glyphicon-trash"></span>
                        {{ 'locale.action.back' | i18n }}
                    </button>
                    <button class="btn" ng-click="deleteAlert()">
                        <span class="glyphicon glyphicon-trash"></span>
                        {{ 'locale.action.delete' | i18n }}
                    </button>
                    <button class="btn" ng-click="updateAlert()">
                        <span class="glyphicon glyphicon-ok"></span>
                        {{ 'locale.action.acknowledge' | i18n }}
                    </button>
                </div>

                <div class="row">
                    <div class="col-xs-1 message-content-icon">
                        <img class="navbar-icon" src="/org.openiz.core/img/msg/{{alert.flags}}.png" />
                    </div>
                    <div class="col-xs-11">
                        <h3 class="no-margin-bottom" style="font-size:20px;">{{ alert.subject }}</h3>
                        <span class="text-muted">{{ alert.time | date : 'yyyy-MMM-dd' }}</span>
                    </div>
                </div>

                <div class="row">
                    <label class="col-xs-2">{{ 'locale.alerts.from' | i18n }}</label>
                    <div class="col-xs-10">{{ alert.from }}</div>
                </div>
                <div class="row">
                    <label class="col-xs-2">{{ 'locale.alerts.to' | i18n }}</label>
                    <div class="col-xs-10">{{ alert.to }}</div>
                </div>
                <div class="row">
                    <hr />
                </div>
                <div class="row">
                    <div class="well" ng-bind-html="alert.body"></div>
                </div>
                
            </div>
            
        </div>
    </div>
        

</div>