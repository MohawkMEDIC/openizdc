angular.module("openiz",[]).provider("localize",function(){this.$get=["$rootScope","$filter",function(){var n={dictionary:OpenIZ.Localization.getStrings(OpenIZ.Localization.getLocale()),setLanguage:function(t){OpenIZ.Localization.getLocale()!=t&&(OpenIZ.Localization.setLocale(t),n.dictionary=OpenIZ.Localization.getStrings(t))},getString:function(t){var r=n.dictionary[t],i;return r!=null?r:(i=OpenIZ.Localization.getString(t),i==null)?t:i}};return n}]}).filter("i18n",["$rootScope","localize",function(n,t){var i=function(n){return t.getString(n)};return i.$stateful=!1,i}]).filter("oizEntityIdentifier",function(){return function(n){if(n.NID!==undefined)return n.NID.value;for(var t in n)return n.NID}}).filter("oizEntityName",function(){return function(n){return OpenIZ.Util.renderName(n)}}).directive("oizTag",function(n){return{require:"ngModel",link:function(t,i,r,u){function f(n){return String(n).split(",")}function e(n){return typeof n===Array?n.join(viewView):n}u.$parsers.unshift(f);u.$formatters.unshift(e);n($(i).tokenfield({delimiter:" ,",createTokensOnBlur:!0}))}}}).directive("oizDatabind",function(n){return{link:function(t,i){n(function(){var u=$(i).attr("oiz-databind"),t=$(i).attr("data-filter"),r=$(i).attr("data-display"),n={};t!==undefined&&(n=JSON.parse(t));n.statusConcept="C8064CBD-FA06-4530-B430-1A52F1530C27";OpenIZ.Ims.get({resource:u,query:n,continueWith:function(n){var t=$(i)[0].options,u,f,e;$("option",i[0]).remove();t[t.length]=new Option(OpenIZ.Localization.getString("locale.common.unknown"));for(u in n.item)f=null,r!=null?(e=n.item[u],f=eval(r)):f=OpenIZ.Util.renderName(n.item[u].name.OfficialRecord),t[t.length]=new Option(f,n.item[u].id)}})})}}}).directive("oizEntitysearch",function(n){return{link:function(t,i){n(function(){var r=$(i).attr("oiz-entitysearch"),t=$(i).attr("data-filter"),u=$(i).attr("data-display"),n={};t!==undefined&&(n=JSON.parse(t));n.statusConcept="C8064CBD-FA06-4530-B430-1A52F1530C27";$(i).attr("style","width:100%; height:100%");$(i).select2({ajax:{url:"/__ims/"+r,dataType:"json",delay:500,method:"GET",data:function(t){return n["name.component.value"]="~"+t.term,n._count=5,n._offset=0,n},processResults:function(n,t){return $("option",i[0]).remove(),t.page=t.page||0,{results:$.map(n.item,function(n){return n.text=n.text||OpenIZ.Util.renderName(n.name.OfficialRecord),n}),pagination:{more:n.offset+n.count<n.total}}},cache:!0},escapeMarkup:function(n){return n},minimumInputLength:4,templateSelection:function(n){return n.name!=null?OpenIZ.Util.renderName(n.name.OfficialRecord):n.text},templateResult:function(n){return n.name!=null?"<div class='label label-default'>"+n.typeConceptModel.name[OpenIZ.Localization.getLocale()]+"<\/div> "+OpenIZ.Util.renderName(n.name.OfficialRecord):n.text}})})}}}).directive("oizCollapseindicator",function(){return{link:function(n,t){$(t).on("hide.bs.collapse",function(){var n=$(this).attr("data-oiz-chevron");$(n).removeClass("glyphicon-chevron-down");$(n).addClass("glyphicon-chevron-right")});$(t).on("show.bs.collapse",function(){var n=$(this).attr("data-oiz-chevron");$(n).addClass("glyphicon-chevron-down");$(n).removeClass("glyphicon-chevron-right")})}}});